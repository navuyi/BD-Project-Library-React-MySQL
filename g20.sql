SET SQL_MODE = "NO_AUTO_VALUE_ON_ZERO";
START TRANSACTION;
SET time_zone = "+00:00";

/*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
/*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
/*!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */;
/*!40101 SET NAMES utf8mb4 */;

CREATE DATABASE IF NOT EXISTS `g20` DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci;
USE `g20`;

CREATE TABLE `authors` (
  `id` int NOT NULL,
  `fname` varchar(45) NOT NULL,
  `lname` varchar(45) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

INSERT INTO `authors` (`id`, `fname`, `lname`) VALUES
(1, 'Mario', 'Puzo'),
(2, 'Howard', 'Wasdin'),
(5, 'James', 'Dashner'),
(6, 'Andy ', 'Weir'),
(7, 'J.R.R', 'Tolkien'),
(8, 'E.B', 'Sledge'),
(9, 'Stephen', 'Hawking'),
(10, 'Jane', 'Austen'),
(11, 'J.K.', 'Rowling'),
(12, 'George', 'Orwell'),
(13, 'Adam', 'Mickiewicz'),
(14, 'Juliusz ', 'Słowacki'),
(15, 'Erich Maria', 'Remarque'),
(17, 'Rafał', 'Figlus'),
(21, 'Rafał', 'NieFiglus'),
(22, 'Karol', 'Wojtyła'),
(23, 'Pan', 'Paweł'),
(24, 'Grey', 'Walker'),
(25, 'Ted', 'Binkovic'),
(27, 'Ulysses', 'Moore'),
(29, 'Nowy', 'Autor'),
(31, 'Mehow', 'Fish'),
(32, 'Juliusz', 'Verne'),
(33, 'Peter', 'Brett');

CREATE TABLE `books` (
  `id` int NOT NULL,
  `title` varchar(255) NOT NULL,
  `year_release` year NOT NULL,
  `author_id` int NOT NULL,
  `publisher_id` int NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

INSERT INTO `books` (`id`, `title`, `year_release`, `author_id`, `publisher_id`) VALUES
(1, 'Ojciec Chrzestny', 1969, 1, 2),
(2, 'Marsjanin', 2015, 6, 2),
(3, 'Władca Pierścieni', 1970, 7, 1),
(4, 'Hobbit', 1924, 7, 1),
(5, 'Teletubisie', 1920, 1, 2),
(6, 'Muminki', 1989, 6, 2),
(7, 'Na Zachodzie Bez Zmian', 1929, 15, 5),
(8, 'Krótka Historia Czasu', 1985, 9, 3),
(30, 'Nowa Książka #2', 1999, 1, 5),
(31, 'Nowa Książka #3', 1999, 1, 5),
(32, 'Nowa Książka #4', 1999, 1, 5),
(34, 'Ziemianin', 2015, 6, 2),
(35, 'Teletubisi', 1920, 1, 2),
(36, 'Teletubisie', 1930, 1, 2),
(37, 'Ojciec Chrzestny', 1962, 1, 5),
(38, 'Ojciec Chrzestny', 1962, 1, 2),
(39, 'Book#56', 1967, 1, 2),
(40, 'Book#69', 1965, 15, 5),
(41, 'Rewolwerowcy', 2001, 23, 4),
(42, 'Wrota Czasu', 2004, 27, 5),
(43, 'Wrota Czasu', 2003, 27, 5),
(44, 'Wrota Czasu', 2003, 27, 2),
(45, 'Modlitwy', 1986, 22, 2),
(46, 'Zmywary i kopary', 2020, 31, 4),
(47, 'Robokop', 1987, 31, 5),
(48, 'Book#456', 1987, 1, 5),
(49, 'Book#49', 1999, 1, 4),
(50, 'Book#91', 2001, 1, 2),
(51, 'Book#67', 1956, 1, 2),
(52, 'Tajemnicza Wyspa', 1976, 32, 4),
(53, 'W 40 dni dookoła świata', 1977, 32, 4),
(54, 'Pięć tygodni w balonie', 1995, 32, 5),
(55, 'Michał Strogow', 1964, 32, 16),
(56, 'Książka o bardzo długim tytule WIADOMO', 2021, 17, 8);

CREATE TABLE `books_has_categories` (
  `books_id` int NOT NULL,
  `categories_id` int NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

INSERT INTO `books_has_categories` (`books_id`, `categories_id`) VALUES
(2, 1),
(3, 1),
(4, 1),
(30, 1),
(31, 1),
(32, 1),
(34, 1),
(44, 1),
(52, 1),
(53, 1),
(3, 2),
(8, 2),
(1, 3),
(5, 3),
(6, 3),
(35, 3),
(36, 3),
(37, 3),
(38, 3),
(48, 3),
(7, 4),
(39, 4),
(40, 4),
(49, 4),
(42, 7),
(43, 7),
(54, 7),
(55, 7),
(41, 24),
(50, 24),
(51, 24),
(45, 31),
(46, 32),
(47, 32),
(56, 35);

CREATE TABLE `book_copies` (
  `id` int NOT NULL,
  `books_id` int NOT NULL,
  `is_rental` tinyint(1) NOT NULL DEFAULT '0'
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

INSERT INTO `book_copies` (`id`, `books_id`, `is_rental`) VALUES
(1, 3, 0),
(2, 3, 0),
(3, 3, 0),
(4, 6, 0),
(5, 6, 0),
(6, 1, 0),
(7, 1, 0),
(8, 2, 1),
(9, 4, 0),
(10, 2, 0),
(11, 6, 0),
(12, 1, 0),
(13, 5, 1),
(14, 3, 0),
(15, 1, 0),
(16, 3, 0),
(17, 4, 0),
(18, 5, 0),
(19, 6, 0),
(20, 8, 0),
(21, 7, 0),
(22, 7, 0),
(33, 30, 0),
(34, 31, 1),
(35, 31, 0),
(36, 31, 0),
(37, 31, 0),
(38, 31, 0),
(39, 31, 0),
(40, 31, 0),
(41, 32, 1),
(42, 32, 0),
(43, 32, 0),
(44, 32, 0),
(45, 32, 0),
(46, 32, 0),
(47, 32, 0),
(48, 2, 0),
(49, 2, 0),
(50, 2, 0),
(51, 2, 0),
(52, 2, 0),
(53, 2, 0),
(54, 32, 0),
(55, 32, 0),
(56, 32, 0),
(57, 32, 0),
(60, 2, 0),
(61, 2, 0),
(62, 2, 0),
(63, 2, 0),
(64, 2, 0),
(65, 2, 0),
(68, 34, 0),
(69, 34, 0),
(70, 5, 0),
(71, 5, 0),
(72, 5, 0),
(73, 5, 0),
(74, 5, 0),
(75, 5, 0),
(76, 35, 0),
(77, 35, 0),
(78, 35, 0),
(79, 35, 0),
(80, 35, 0),
(81, 35, 0),
(82, 36, 0),
(83, 36, 0),
(84, 36, 0),
(85, 36, 0),
(86, 36, 0),
(87, 36, 0),
(88, 36, 0),
(89, 36, 0),
(90, 36, 0),
(91, 36, 0),
(92, 36, 0),
(93, 36, 0),
(94, 36, 0),
(95, 36, 0),
(96, 36, 0),
(97, 36, 0),
(98, 36, 0),
(99, 36, 0),
(100, 37, 1),
(101, 37, 1),
(102, 37, 0),
(103, 37, 0),
(104, 37, 0),
(105, 37, 0),
(106, 37, 0),
(107, 37, 0),
(108, 37, 0),
(109, 37, 0),
(110, 37, 0),
(111, 37, 0),
(112, 37, 0),
(113, 37, 0),
(114, 37, 0),
(115, 37, 0),
(116, 37, 0),
(117, 37, 0),
(118, 37, 0),
(119, 37, 0),
(120, 37, 0),
(121, 37, 0),
(122, 37, 0),
(123, 37, 0),
(124, 37, 0),
(125, 37, 0),
(126, 37, 0),
(127, 37, 0),
(128, 37, 0),
(129, 37, 0),
(130, 37, 0),
(131, 37, 0),
(132, 37, 0),
(133, 37, 0),
(134, 37, 0),
(135, 37, 0),
(136, 37, 0),
(137, 37, 0),
(138, 37, 0),
(139, 37, 0),
(140, 37, 0),
(141, 37, 0),
(142, 37, 0),
(143, 37, 0),
(144, 37, 0),
(145, 37, 0),
(146, 37, 0),
(147, 37, 0),
(148, 37, 0),
(149, 37, 0),
(150, 38, 0),
(151, 38, 0),
(152, 38, 0),
(153, 38, 0),
(154, 38, 0),
(155, 38, 0),
(156, 38, 0),
(157, 38, 0),
(158, 38, 0),
(159, 38, 0),
(160, 38, 0),
(161, 38, 0),
(162, 38, 0),
(163, 38, 0),
(164, 38, 0),
(165, 38, 0),
(166, 38, 0),
(167, 38, 0),
(168, 38, 0),
(169, 38, 0),
(170, 38, 0),
(171, 38, 0),
(172, 38, 0),
(173, 38, 0),
(174, 38, 0),
(175, 38, 0),
(176, 38, 0),
(177, 38, 0),
(178, 38, 0),
(179, 38, 0),
(180, 38, 0),
(181, 38, 0),
(182, 38, 0),
(183, 38, 0),
(184, 38, 0),
(185, 38, 0),
(186, 38, 0),
(187, 38, 0),
(188, 38, 0),
(189, 38, 0),
(190, 38, 0),
(191, 38, 0),
(192, 38, 0),
(193, 38, 0),
(194, 38, 0),
(195, 38, 0),
(196, 38, 0),
(197, 38, 0),
(198, 38, 0),
(199, 38, 0),
(200, 39, 0),
(201, 39, 0),
(202, 39, 0),
(203, 39, 0),
(204, 39, 0),
(205, 39, 0),
(206, 40, 0),
(207, 40, 0),
(208, 40, 0),
(209, 40, 0),
(210, 40, 0),
(211, 40, 0),
(212, 40, 0),
(213, 40, 0),
(214, 40, 0),
(215, 40, 0),
(216, 41, 0),
(217, 41, 0),
(218, 41, 0),
(219, 41, 0),
(220, 41, 0),
(221, 41, 0),
(222, 41, 0),
(223, 41, 0),
(224, 41, 0),
(225, 41, 0),
(226, 42, 0),
(227, 42, 0),
(228, 42, 0),
(229, 42, 0),
(230, 42, 0),
(231, 42, 0),
(232, 42, 0),
(233, 42, 0),
(234, 42, 0),
(235, 42, 0),
(236, 42, 0),
(237, 42, 0),
(238, 42, 0),
(239, 42, 0),
(240, 42, 0),
(241, 42, 0),
(242, 42, 0),
(243, 42, 0),
(244, 42, 0),
(245, 42, 0),
(246, 42, 0),
(247, 42, 0),
(248, 43, 0),
(249, 43, 0),
(250, 43, 0),
(251, 43, 0),
(252, 43, 0),
(253, 43, 0),
(254, 43, 0),
(255, 43, 0),
(256, 43, 0),
(257, 43, 0),
(258, 43, 0),
(259, 43, 0),
(260, 43, 0),
(261, 43, 0),
(262, 43, 0),
(263, 43, 0),
(264, 43, 0),
(265, 43, 0),
(266, 43, 0),
(267, 43, 0),
(268, 43, 0),
(269, 43, 0),
(270, 43, 0),
(271, 43, 0),
(272, 43, 0),
(273, 43, 0),
(274, 43, 0),
(275, 43, 0),
(276, 43, 0),
(277, 43, 0),
(278, 43, 0),
(279, 43, 0),
(280, 43, 0),
(281, 43, 0),
(282, 43, 0),
(283, 43, 0),
(284, 43, 0),
(285, 43, 0),
(286, 43, 0),
(287, 43, 0),
(288, 43, 0),
(289, 43, 0),
(290, 43, 0),
(291, 43, 0),
(292, 43, 0),
(293, 43, 0),
(294, 43, 0),
(295, 43, 0),
(296, 43, 0),
(297, 43, 0),
(298, 43, 0),
(299, 43, 0),
(300, 43, 0),
(301, 43, 0),
(302, 43, 0),
(303, 43, 0),
(304, 43, 0),
(305, 44, 0),
(306, 44, 0),
(307, 44, 0),
(308, 44, 0),
(309, 44, 0),
(310, 45, 0),
(311, 45, 0),
(312, 45, 0),
(313, 45, 0),
(314, 45, 0),
(315, 45, 0),
(316, 45, 0),
(317, 45, 0),
(318, 45, 0),
(319, 45, 0),
(320, 46, 0),
(321, 46, 0),
(322, 46, 0),
(323, 46, 0),
(324, 46, 0),
(325, 46, 0),
(326, 46, 0),
(327, 46, 0),
(328, 46, 0),
(329, 46, 0),
(330, 47, 0),
(331, 48, 0),
(332, 48, 0),
(333, 48, 0),
(334, 48, 0),
(335, 48, 0),
(336, 48, 0),
(337, 48, 0),
(338, 48, 0),
(339, 48, 0),
(340, 48, 0),
(341, 48, 0),
(342, 48, 0),
(343, 48, 0),
(344, 48, 0),
(345, 48, 0),
(346, 48, 0),
(347, 48, 0),
(348, 48, 0),
(349, 48, 0),
(350, 49, 0),
(351, 49, 0),
(352, 49, 0),
(353, 49, 0),
(354, 49, 0),
(355, 49, 0),
(356, 49, 0),
(357, 49, 0),
(358, 49, 0),
(359, 49, 0),
(360, 49, 0),
(361, 49, 0),
(362, 50, 0),
(363, 50, 0),
(364, 50, 0),
(365, 50, 0),
(366, 50, 0),
(367, 50, 0),
(368, 50, 0),
(369, 51, 0),
(370, 51, 0),
(371, 51, 0),
(372, 51, 0),
(373, 51, 0),
(374, 51, 0),
(375, 51, 0),
(376, 51, 0),
(377, 51, 0),
(378, 51, 0),
(379, 52, 0),
(380, 52, 0),
(381, 52, 0),
(382, 52, 0),
(383, 52, 0),
(384, 53, 1),
(385, 53, 0),
(386, 53, 0),
(387, 53, 0),
(388, 53, 0),
(389, 53, 0),
(390, 53, 0),
(391, 53, 0),
(392, 53, 0),
(393, 53, 0),
(394, 53, 0),
(395, 53, 0),
(396, 53, 0),
(397, 54, 0),
(398, 54, 0),
(399, 54, 0),
(400, 54, 0),
(401, 54, 0),
(402, 54, 0),
(403, 54, 0),
(404, 54, 0),
(405, 54, 0),
(406, 54, 0),
(407, 54, 0),
(408, 54, 0),
(409, 54, 0),
(410, 54, 0),
(411, 54, 0),
(412, 54, 0),
(413, 54, 0),
(414, 54, 0),
(415, 54, 0),
(416, 54, 0),
(417, 54, 0),
(418, 55, 0),
(419, 55, 0),
(420, 55, 0),
(421, 55, 0),
(422, 55, 0),
(423, 55, 0),
(424, 56, 0);

CREATE TABLE `categories` (
  `id` int NOT NULL,
  `name` varchar(255) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

INSERT INTO `categories` (`id`, `name`) VALUES
(14, 'Bajki'),
(35, 'Bzdury'),
(2, 'Edukacja'),
(1, 'Fantastyka'),
(5, 'Historyczne'),
(8, 'Informatyka'),
(9, 'Kinematografia'),
(23, 'Klawiatury'),
(31, 'Kościół'),
(3, 'Kryminał'),
(6, 'Kulinarne'),
(22, 'Magia'),
(33, 'Motoryzacja'),
(15, 'Przedpotopowe'),
(7, 'Przygodowe'),
(24, 'Rowery'),
(11, 'Sci-Fi'),
(20, 'SoftPop'),
(32, 'Studia'),
(4, 'Wojenne'),
(16, 'Wyścigowe');

CREATE TABLE `orders` (
  `id` int NOT NULL,
  `user_id` int NOT NULL,
  `order_date` date NOT NULL,
  `pickup_date` date NOT NULL,
  `return_date` date NOT NULL,
  `book_copies_id` int NOT NULL,
  `is_prolonged` tinyint(1) NOT NULL DEFAULT '0'
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

INSERT INTO `orders` (`id`, `user_id`, `order_date`, `pickup_date`, `return_date`, `book_copies_id`, `is_prolonged`) VALUES
(172, 1, '2021-01-18', '2021-01-19', '2021-02-18', 13, 0),
(177, 1, '2021-01-18', '2021-01-20', '2021-03-21', 34, 1),
(178, 1, '2021-01-18', '2021-01-20', '2021-03-21', 41, 1),
(179, 1, '2021-01-18', '2021-01-20', '2021-02-19', 100, 0),
(180, 2, '2021-01-18', '2021-01-19', '2021-02-18', 8, 0),
(182, 16, '2021-01-18', '2021-01-19', '2021-02-18', 384, 0),
(183, 30, '2021-01-18', '2021-01-21', '2021-02-20', 101, 0);
DELIMITER $$
CREATE TRIGGER `book_return` AFTER DELETE ON `orders` FOR EACH ROW UPDATE book_copies SET is_rental = 0
WHERE id = OLD.book_copies_id
$$
DELIMITER ;
DELIMITER $$
CREATE TRIGGER `increase_rented` AFTER INSERT ON `orders` FOR EACH ROW UPDATE users SET rented_books = rented_books + 1 WHERE id = NEW.user_id
$$
DELIMITER ;
DELIMITER $$
CREATE TRIGGER `rent_a_book` AFTER INSERT ON `orders` FOR EACH ROW UPDATE book_copies
     SET is_rental = 1
   WHERE id = NEW.book_copies_id
$$
DELIMITER ;

CREATE TABLE `publishers` (
  `id` int NOT NULL,
  `name` varchar(45) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

INSERT INTO `publishers` (`id`, `name`) VALUES
(5, 'Magnum'),
(13, 'New Publisher#56'),
(2, 'Nowa Era'),
(8, 'Nowa Giera'),
(15, 'Nowy'),
(12, 'Nowy Publisher'),
(3, 'Pruszyński i S-ka'),
(9, 'Rozenbaum'),
(1, 'Smyk'),
(4, 'Zielona Sowa'),
(6, 'Znak'),
(16, 'Zysk i S-ka');

CREATE TABLE `users` (
  `id` int NOT NULL,
  `fname` varchar(255) NOT NULL,
  `lname` varchar(255) NOT NULL,
  `password` varchar(255) NOT NULL,
  `email` varchar(45) NOT NULL,
  `rented_books` int NOT NULL DEFAULT '0',
  `is_admin` tinyint(1) NOT NULL DEFAULT '0'
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

INSERT INTO `users` (`id`, `fname`, `lname`, `password`, `email`, `rented_books`, `is_admin`) VALUES
(1, 'Michu', 'Ryba', 'a665a45920422f9d417e4867efdc4fb8a04a1f3fff1fa07e998e86f7f7a27ae3', 'ryba@wp.pl', 49, 1),
(2, 'John', 'Silver', '9d777935627a29c77604c57273520eb42635fd1847d2eeea1e7441fbaeb26253', 'pirat@pirates.com', 39, 0),
(5, 'kon', 'rafal', 'a665a45920422f9d417e4867efdc4fb8a04a1f3fff1fa07e998e86f7f7a27ae3', 'konrafal@wp.pl', 0, 0),
(6, '12312', '123123', 'a665a45920422f9d417e4867efdc4fb8a04a1f3fff1fa07e998e86f7f7a27ae3', 'elo@wp.pl', 0, 0),
(7, 'admin', 'admin', '8c6976e5b5410415bde908bd4dee15dfb167a9c873fc4bb8a81f6f2ab448a918', 'admin@admin.com', 0, 0),
(9, 'Adam', 'Bania', 'a665a45920422f9d417e4867efdc4fb8a04a1f3fff1fa07e998e86f7f7a27ae3', 'adambania@gmail.com', 2, 0),
(10, 'Filip', 'Kaczmarczyk', 'a665a45920422f9d417e4867efdc4fb8a04a1f3fff1fa07e998e86f7f7a27ae3', 'filipkurwa@wp.pl', 0, 0),
(11, 'Martineczka', 'P', 'a665a45920422f9d417e4867efdc4fb8a04a1f3fff1fa07e998e86f7f7a27ae3', 'dupa@abc.pl', 0, 0),
(12, 'aaa', 'bbb', 'f3133d075581b84d5c96539c53a37aedf743df472b097b67540749241c991d4c', 'ccc@pl.pl', 21, 0),
(13, 'Adam', 'Bania', 'a665a45920422f9d417e4867efdc4fb8a04a1f3fff1fa07e998e86f7f7a27ae3', 'adambania@wp.pl', 2, 0),
(14, 'Julia', 'Kułacz', '0fc5ec3ed9da5f88024a9e1b08d2ea1e480458c26cf65eafd9a5e2ac2bc62b62', 'julka@gmail.com', 1, 0),
(16, 'admin', 'admin', 'b94899389637121e38c54c0efe9100abef362fe64bbb164e7f802c1c19e084d5', 'true_admin@admin.com', 2, 1),
(17, 'julia', 'kulacz', 'e73b79a0b10f8cdb6ac7dbe4c0a5e25776e1148784b86cf98f7d6719d472af69', 'badboyjulka@gmail.com', 2, 0),
(18, 'koko', 'koko', '5d1a14edf2ae5b94e8f7b3a4a287614fbef04051b031b212ecbd21d1b0606443', 'koko@o2.pl', 1, 0),
(19, ';delete from user where id=18;', '12', '0ffe1abd1a08215353c233d6e009613e95eec4253832a761af28ff37ac5a150c', '12@12', 0, 0),
(20, 'witam', 'witam', '361db8d815985a6469626f62897d7929cb331be295a3912bf90df64129b54ed7', 'witam@o2.pl', 0, 0),
(21, ';delete from user;', 'sql sql', 'a15f8ae07675bfb96e084bfb4f52fb2c22091061aae86e0eb76a55f4e52dd74e', 'sqlinject@agh.pl', 0, 0),
(22, ';delete from user where id=20;', '1', '6b86b273ff34fce19d6b804eff5a3f5747ada4eaa22f1d49c01e52ddb7875b4b', '1@o2.pl', 0, 0),
(23, 'test', 'test', '9f86d081884c7d659a2feaa0c55ad015a3bf4f1b2b0b822cd15d6c15b0f00a08', 'test@test.pl', 0, 0),
(24, 'elo', 'ole', '5b5c101835bbe79e33418c3697b7348d3fdd241803d50d1c1088426fa0bf3d1b', 'ole@elo.com', 1, 0),
(25, 'Juliusz', 'Verne', '8d6c5597d25eca212ea6c6cacc0a02e247b8c631343a70147cb81374ff72f414', 'jules@verne.com', 0, 0),
(28, 'mama', 'tata', 'a665a45920422f9d417e4867efdc4fb8a04a1f3fff1fa07e998e86f7f7a27ae3', 'mamatat123@wp.pl', 0, 0),
(29, 'tata', 'tata', 'a665a45920422f9d417e4867efdc4fb8a04a1f3fff1fa07e998e86f7f7a27ae3', 'tata@wp.pl', 0, 0),
(30, 'Twoja', 'stara', '1c75903328ae069246cad10879676634b1ce0b053dd0749fe3e3187c4c59d6f4', 'mail@wp.pl', 1, 0);


ALTER TABLE `authors`
  ADD PRIMARY KEY (`id`),
  ADD UNIQUE KEY `id_UNIQUE` (`id`);

ALTER TABLE `books`
  ADD PRIMARY KEY (`id`),
  ADD UNIQUE KEY `id_UNIQUE` (`id`),
  ADD KEY `fk_books_authors1_idx` (`author_id`),
  ADD KEY `fk_books_publishers1_idx` (`publisher_id`);

ALTER TABLE `books_has_categories`
  ADD PRIMARY KEY (`books_id`,`categories_id`),
  ADD KEY `fk_books_has_categories_categories1_idx` (`categories_id`),
  ADD KEY `fk_books_has_categories_books1_idx` (`books_id`);

ALTER TABLE `book_copies`
  ADD PRIMARY KEY (`id`),
  ADD UNIQUE KEY `id_UNIQUE` (`id`),
  ADD KEY `fk_book_copies_books1_idx` (`books_id`);

ALTER TABLE `categories`
  ADD PRIMARY KEY (`id`),
  ADD UNIQUE KEY `id_UNIQUE` (`id`),
  ADD UNIQUE KEY `name_UNIQUE` (`name`);

ALTER TABLE `orders`
  ADD PRIMARY KEY (`id`),
  ADD UNIQUE KEY `id_UNIQUE` (`id`),
  ADD KEY `fk_order_users1_idx` (`user_id`),
  ADD KEY `fk_order_book_copies1_idx` (`book_copies_id`);

ALTER TABLE `publishers`
  ADD PRIMARY KEY (`id`),
  ADD UNIQUE KEY `id_UNIQUE` (`id`),
  ADD UNIQUE KEY `name_UNIQUE` (`name`);

ALTER TABLE `users`
  ADD PRIMARY KEY (`id`),
  ADD UNIQUE KEY `id_UNIQUE` (`id`),
  ADD UNIQUE KEY `email_UNIQUE` (`email`);


ALTER TABLE `authors`
  MODIFY `id` int NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=34;

ALTER TABLE `books`
  MODIFY `id` int NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=57;

ALTER TABLE `book_copies`
  MODIFY `id` int NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=425;

ALTER TABLE `categories`
  MODIFY `id` int NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=36;

ALTER TABLE `orders`
  MODIFY `id` int NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=184;

ALTER TABLE `publishers`
  MODIFY `id` int NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=17;

ALTER TABLE `users`
  MODIFY `id` int NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=33;


ALTER TABLE `books`
  ADD CONSTRAINT `fk_books_authors1` FOREIGN KEY (`author_id`) REFERENCES `authors` (`id`),
  ADD CONSTRAINT `fk_books_publishers1` FOREIGN KEY (`publisher_id`) REFERENCES `publishers` (`id`);

ALTER TABLE `books_has_categories`
  ADD CONSTRAINT `fk_books_has_categories_books1` FOREIGN KEY (`books_id`) REFERENCES `books` (`id`),
  ADD CONSTRAINT `fk_books_has_categories_categories1` FOREIGN KEY (`categories_id`) REFERENCES `categories` (`id`);

ALTER TABLE `book_copies`
  ADD CONSTRAINT `fk_book_copies_books1` FOREIGN KEY (`books_id`) REFERENCES `books` (`id`);

ALTER TABLE `orders`
  ADD CONSTRAINT `fk_order_book_copies1` FOREIGN KEY (`book_copies_id`) REFERENCES `book_copies` (`id`),
  ADD CONSTRAINT `fk_order_users1` FOREIGN KEY (`user_id`) REFERENCES `users` (`id`);
COMMIT;

/*!40101 SET CHARACTER_SET_CLIENT=@OLD_CHARACTER_SET_CLIENT */;
/*!40101 SET CHARACTER_SET_RESULTS=@OLD_CHARACTER_SET_RESULTS */;
/*!40101 SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION */;
